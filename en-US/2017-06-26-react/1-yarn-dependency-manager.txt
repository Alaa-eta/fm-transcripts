[00:00:00]
>> Brian Holt: Now that you have the start branch, hopefully, hopefully you have nodes six plus seven-ish installed. I installed mine using MVM. It's totally up to you how to do that, but I find MVM to be very convenient. Next thing we're gonna talk about is Yarn. So many of you are probably accustomed to seeing npm lots of places.

[00:00:28]
Npm doesn't stand for node package manager but that's what I think of it as. [LAUGH] It's basically a way to install dependencies for JavaScript type projects. And they ship a client called npm. And it's been really great for a long time. However, if you're doing deployments it's really tough because npm is non deterministic as of npm three, four-ish.

[00:00:54]
This is gonna change with npm five. Npm five will become deterministic and it's also going to do locking as well. But that is still not released. It's actually coming out with Note 8 today. So that's why we're not teaching it today and we're gonna stick with yarn. The fine people over at Facebook were frustrated with their deployments, so they came up with a npm client called yarn.

[00:01:18]
And what yarn does is it creates these lock files which we were just looking at, that locks down all of your dependencies. What's really cool about that is it's deterministic. When I say the term, deterministic, it means I can run it ten billion times and on the ten billion and first time it's gonna run the exact same way.

[00:01:33]
And you do not have that guarantee with npm three, which is the one that the previous versions of node shipped with. So what's frustrating about that is when you're doing deployments, you don't know what state your node modual's directory is gonna end up in, which is a problem as you may imagine, right?

[00:01:54]
You can do 10,000 deploys and 50 of them failed for unknown reasons and you can't reproduce why they failed. Like, it's a serious problem, right? So they came up with this yarn dependency manager. It's faster than npm three and it's deterministic. And it also has a flat structure, which are all very positive things for deployments.

[00:02:17]
So today, we're going to be using yarn. So if you don't already have it installed, I'll show you how to install it real quick. You do npm install -- global yarn, like that.
>> Brian Holt: I already have it, so I'm not gonna run that, but that's how you would do it.

[00:02:38]
And then at that point, you should be able to say yarn -v.
>> Brian Holt: I guess it's gonna do the installations. I guess -v does not do version. In any case, let's stop that for a second.
>> Brian Holt: So I have yarn already installed and now I am inside the start branch, and I'm going to run yarn.

[00:02:59]
What this is gonna do, this is like the npm install. It's gonna go through and install all my dependencies based on what I have in package.json and the yarn lock file. So I'm gonna say yarn, and then it's just gonna do this magic, and it's going to install all of my dependencies for me.

[00:03:18]

>> Brian Holt: Now to be fair, you can totally run npm install and not use yarn and I'm 99% sure it's gonna work. But it's nondeterministic so you can't truly be sure. No I'm just kidding, you can be pretty sure, but. So now if we look in our node_modules. Mine was pretty fast.

[00:03:35]
Mine only took 13 seconds because most of that was already cached for me. If you're doing this cold for the first time and are not on gigabit, it might take a little bit longer. So if I go into node modules, and look, I have a shit-ton of dependencies installed now.

[00:03:55]

>> Brian Holt: So this is something that people that like to complain about Node like to complain about. Is that there are just a crazy amount of dependencies. I'm not gonna deny that, there's a crazy amount of dependencies. However, you have to keep in mind that yarn installs all these node modules totally flat.

[00:04:12]
So everything that gets included that includes something else that includes something else is all installed flat, which is not how npm installs them. Yarn actually goes through and links them all into the respective node modules directories, which is pretty cool.
>> Brian Holt: Cool.
>> Brian Holt: So now that we've done yarn installs,

[00:04:44]

>> Brian Holt: We're gonna go ahead and skip the global installs for now. But just so you know, you can also do global yarn installs. You can do yarn global add blank. So if I was gonna do nodemon or something like that, that's how you'd do that and that would be a global install for yarn.

[00:05:03]

>> Brian Holt: And if you wanna add new dependencies to a repo, you say yarn add and then react, right? Something like that.
>> Brian Holt: Instead of vr install, right, it's yarn add. And then by the same token, yarn remove. The nice thing about yarn is it saves by default. You don't have to do npm install--save, right?

[00:05:28]
Also the true of npm five, they're dropping the --save, it's gonna just save by default which is gonna be great. And if you wanted to save it to dev, you're gonna say yarn --dev eslint or something like that, right? And that is the full tour. That is how you use yarn.

[00:05:47]
Question from online?
>> Speaker 2: He's asking if yarn adds updates that package.json.
>> Brian Holt: It does. Yeah, it'll update the package.json and it'll update the lock file for you automatically.
>> Brian Holt: Same thing with npm five. It's gonna ship with a new file called package-lock.json and when you install, it will also update that as well.

[00:06:08]
So npm three has something called ShrinkWrap, which will be, I think, slowly be phased out in favor of Package Lock. And if you don't know what it is, it's okay. Like, let's just go forward with yarn and Package Lock.
>> Speaker 2: Are these npm updates supposed to just kind of displace yarn?

[00:06:35]
Like, is that what they're trying to do?
>> Brian Holt: It's a good question.
>> Speaker 2: They said they were just working on it actually beforehand, and then yarn kind of like came out.
>> Brian Holt: Yeah.
>> Speaker 2: And it looked like they were kind of back peddling and filling in gaps. But I don't know, it's hard to say.

[00:06:54]

>> Brian Holt: It's kind of a weird situation. Not to plug myself too much here, but the last episode of the podcast we launched actually had Laurie Voss from npm on, and he talks a lot about that whole situation. So there's good history there if you wanna talk. They're super chill with each other is the sum of the story, right?

[00:07:12]
They're both gonna coexist and push each other forward, I think, is the sum of the story for now.
>> Speaker 2: Npm five is definitely a big step up.
>> Brian Holt: Yeah, for sure, npm five is gonna be awesome.

